{% extends 'index.html' %}
{% block titolo %}NigroOS - Thread e Semafori{% endblock %}
{% block intestazione %}Gestione dei Thread e Semafori{% endblock %}
{% block corpo %}
<div class="w3-container">
  <h2>Thread in NigroOS</h2>
  <p style="text-align: justify;">
    In NigroOS, i thread sono unità fondamentali di esecuzione che condividono lo stesso spazio di memoria. 
    La gestione efficiente dei thread è cruciale per le prestazioni del sistema.
  </p>
  
  <h3>Esempio di codice per la creazione di thread</h3>
  <pre style="background-color: #f5f5f5; padding: 15px; border-radius: 5px;">
#include <nigrothread.h>

void* task(void* arg) {
    printf("Thread in esecuzione\n");
    return NULL;
}

int main() {
    nthread_t thread1;
    nthread_create(&thread1, NULL, task, NULL);
    nthread_join(thread1, NULL);
    return 0;
}</pre>
  
  <h2>Semafori in NigroOS</h2>
  <p style="text-align: justify;">
    I semafori sono strutture di sincronizzazione che controllano l'accesso a risorse condivise. 
    NigroOS implementa semafori binari e contatori con algoritmi ad alta efficienza.
  </p>
  
  <h3>Esempio di utilizzo dei semafori</h3>
  <pre style="background-color: #f5f5f5; padding: 15px; border-radius: 5px;">
class Semaforo {
    private final String nome;
    private String colore;

    public Semaforo(String nome) {
        this.nome = nome;
        this.colore = "ROSSO";
    }

    public void setColore(String colore) {
        this.colore = colore;
    }

    public void stampa() {
        System.out.println(nome + ": " + colore);
    }
}

class Controller {
    private final Semaforo[] semafori;

    public Controller() {
        semafori = new Semaforo[3];
        semafori[0] = new Semaforo("SEMAFORO 1");
        semafori[1] = new Semaforo("SEMAFORO 2");
        semafori[2] = new Semaforo("SEMAFORO 3");
    }

    public void eseguiCicli(int numeroCicli) {
        for (int ciclo = 0; ciclo < numeroCicli; ciclo++) {
            int fase = ciclo % 3;

            // Reset colori
            for (Semaforo s : semafori) {
                s.setColore("ROSSO");
            }

            switch (fase) {
                case 0:
                    semafori[0].setColore("VERDE");   // S1 verde
                    semafori[1].setColore("ROSSO");   // S2 rosso
                    semafori[2].setColore("GIALLO");  // S3 giallo
                    break;
                case 1:
                    semafori[0].setColore("GIALLO");  // S1 giallo
                    semafori[1].setColore("VERDE");   // S2 verde
                    semafori[2].setColore("ROSSO");   // S3 rosso
                    break;
                case 2:
                    semafori[0].setColore("ROSSO");   // S1 rosso
                    semafori[1].setColore("GIALLO");  // S2 giallo
                    semafori[2].setColore("VERDE");   // S3 verde
                    break;
            }

            for (Semaforo s : semafori) {
                s.stampa();
            }

            System.out.println();

            try {
                Thread.sleep(3000); // pausa tra un ciclo e l'altro
            } catch (InterruptedException e) {
                System.out.println("Simulazione interrotta.");
            }
        }

        System.out.println("Fine simulazione.");
    }
}

public class ControlloSemaforo {
    public static void main(String[] args) {
        Controller controller = new Controller();
        controller.eseguiCicli(6); // esegui 6 cicli
    }
}
}
</pre>
</div>

<style>
  h2 {
    color: #333;
    margin-top: 20px;
  }
  h3 {
    color: #555;
    margin-top: 15px;
  }
  pre {
    font-family: 'Courier New', monospace;
    font-size: 14px;
  }
</style>
{% endblock %}